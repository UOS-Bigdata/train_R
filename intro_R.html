<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.49">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="서울시립대학교 빅데이터 혁신융합대학 사업단">
<meta name="dcterms.date" content="2026-01-21">

<title>스포츠과학원 재직자교육 - R을 활용한 데이터 분석</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="intro_R_files/libs/clipboard/clipboard.min.js"></script>
<script src="intro_R_files/libs/quarto-html/quarto.js"></script>
<script src="intro_R_files/libs/quarto-html/popper.min.js"></script>
<script src="intro_R_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="intro_R_files/libs/quarto-html/anchor.min.js"></script>
<link href="intro_R_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="intro_R_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="intro_R_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="intro_R_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="intro_R_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#패키지-로드-및-데이터-불러오기" id="toc-패키지-로드-및-데이터-불러오기" class="nav-link active" data-scroll-target="#패키지-로드-및-데이터-불러오기">패키지 로드 및 데이터 불러오기</a>
  <ul class="collapse">
  <li><a href="#패키지-불러오기-library" id="toc-패키지-불러오기-library" class="nav-link" data-scroll-target="#패키지-불러오기-library">패키지 불러오기 (<code>library()</code>)</a></li>
  <li><a href="#외부-데이터-불러오기" id="toc-외부-데이터-불러오기" class="nav-link" data-scroll-target="#외부-데이터-불러오기">외부 데이터 불러오기</a></li>
  </ul></li>
  <li><a href="#r의-기초" id="toc-r의-기초" class="nav-link" data-scroll-target="#r의-기초">1. R의 기초</a>
  <ul class="collapse">
  <li><a href="#연산" id="toc-연산" class="nav-link" data-scroll-target="#연산">1.1 연산</a>
  <ul class="collapse">
  <li><a href="#기초-연산" id="toc-기초-연산" class="nav-link" data-scroll-target="#기초-연산">1.1.1 기초 연산</a></li>
  <li><a href="#비교-연산" id="toc-비교-연산" class="nav-link" data-scroll-target="#비교-연산">1.1.2 비교 연산</a></li>
  </ul></li>
  <li><a href="#변수" id="toc-변수" class="nav-link" data-scroll-target="#변수">1.2 변수</a>
  <ul class="collapse">
  <li><a href="#변수-할당" id="toc-변수-할당" class="nav-link" data-scroll-target="#변수-할당">1.2.1 변수 할당</a></li>
  <li><a href="#변수-이름-규칙" id="toc-변수-이름-규칙" class="nav-link" data-scroll-target="#변수-이름-규칙">1.2.2 변수 이름 규칙</a></li>
  <li><a href="#변수-제거" id="toc-변수-제거" class="nav-link" data-scroll-target="#변수-제거">1.2.3 변수 제거</a></li>
  </ul></li>
  <li><a href="#데이터타입" id="toc-데이터타입" class="nav-link" data-scroll-target="#데이터타입">1.3 데이터타입</a></li>
  <li><a href="#numeric-자료" id="toc-numeric-자료" class="nav-link" data-scroll-target="#numeric-자료">1.3.1 <code>numeric</code> 자료</a></li>
  <li><a href="#character-자료" id="toc-character-자료" class="nav-link" data-scroll-target="#character-자료">1.3.2 <code>character</code> 자료</a></li>
  <li><a href="#logical-자료" id="toc-logical-자료" class="nav-link" data-scroll-target="#logical-자료">1.3.3 <code>logical</code> 자료</a>
  <ul class="collapse">
  <li><a href="#벡터-vector" id="toc-벡터-vector" class="nav-link" data-scroll-target="#벡터-vector">1.4 벡터 (Vector)</a></li>
  <li><a href="#벡터-연산" id="toc-벡터-연산" class="nav-link" data-scroll-target="#벡터-연산">1.4.1 벡터 연산</a></li>
  <li><a href="#벡터-인덱싱" id="toc-벡터-인덱싱" class="nav-link" data-scroll-target="#벡터-인덱싱">1.4.2 벡터 인덱싱</a></li>
  <li><a href="#범주형-벡터-factor-vector" id="toc-범주형-벡터-factor-vector" class="nav-link" data-scroll-target="#범주형-벡터-factor-vector">1.4.3 범주형 벡터 (<code>factor</code> vector)</a></li>
  <li><a href="#벡터-관련-주요함수" id="toc-벡터-관련-주요함수" class="nav-link" data-scroll-target="#벡터-관련-주요함수">1.4.4 벡터 관련 주요함수</a></li>
  <li><a href="#na-vs-null" id="toc-na-vs-null" class="nav-link" data-scroll-target="#na-vs-null">1.4.5 NA vs NULL</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#데이터-프레임-i" id="toc-데이터-프레임-i" class="nav-link" data-scroll-target="#데이터-프레임-i">2. 데이터 프레임 I</a>
  <ul class="collapse">
  <li><a href="#데이터-프레임의-생성" id="toc-데이터-프레임의-생성" class="nav-link" data-scroll-target="#데이터-프레임의-생성">2.1 데이터 프레임의 생성</a></li>
  <li><a href="#데이터프레임-정보-요약하기" id="toc-데이터프레임-정보-요약하기" class="nav-link" data-scroll-target="#데이터프레임-정보-요약하기">2.2 데이터프레임 정보 요약하기</a>
  <ul class="collapse">
  <li><a href="#nrow-ncol-그리고-dim" id="toc-nrow-ncol-그리고-dim" class="nav-link" data-scroll-target="#nrow-ncol-그리고-dim">2.2.1 <code>nrow()</code>, <code>ncol()</code> 그리고 <code>dim()</code></a></li>
  <li><a href="#names" id="toc-names" class="nav-link" data-scroll-target="#names">2.2.2 <code>names()</code></a></li>
  <li><a href="#str" id="toc-str" class="nav-link" data-scroll-target="#str">2.2.3 <code>str()</code></a></li>
  <li><a href="#head-그리고-tail" id="toc-head-그리고-tail" class="nav-link" data-scroll-target="#head-그리고-tail">2.2.4 <code>head()</code> 그리고 <code>tail()</code></a></li>
  <li><a href="#변수선택-연산자" id="toc-변수선택-연산자" class="nav-link" data-scroll-target="#변수선택-연산자">2.2.5 변수선택 (<code>$</code> 연산자)</a></li>
  </ul></li>
  <li><a href="#데이터프레임-주요-함수" id="toc-데이터프레임-주요-함수" class="nav-link" data-scroll-target="#데이터프레임-주요-함수">2.3 데이터프레임 주요 함수</a>
  <ul class="collapse">
  <li><a href="#table-함수" id="toc-table-함수" class="nav-link" data-scroll-target="#table-함수">2.3.1 <code>table()</code> 함수</a></li>
  <li><a href="#colsums와-colmeans" id="toc-colsums와-colmeans" class="nav-link" data-scroll-target="#colsums와-colmeans">2.3.2 <code>colSums()</code>와 <code>colMeans()</code></a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">2.3.3 <code>summary()</code></a></li>
  </ul></li>
  <li><a href="#데이터프레임-인덱싱" id="toc-데이터프레임-인덱싱" class="nav-link" data-scroll-target="#데이터프레임-인덱싱">2.4 데이터프레임 인덱싱</a>
  <ul class="collapse">
  <li><a href="#연산자---행과-열-모두-인덱싱가능" id="toc-연산자---행과-열-모두-인덱싱가능" class="nav-link" data-scroll-target="#연산자---행과-열-모두-인덱싱가능">2.4.1 <code>[]</code> 연산자 - 행과 열 모두 인덱싱가능</a></li>
  <li><a href="#복합조건-인덱싱-and-or" id="toc-복합조건-인덱싱-and-or" class="nav-link" data-scroll-target="#복합조건-인덱싱-and-or">2.4.2 복합조건 인덱싱 (and, or)</a></li>
  <li><a href="#예제" id="toc-예제" class="nav-link" data-scroll-target="#예제">2.5 예제</a></li>
  </ul></li>
  <li><a href="#데이터프레임-합치기" id="toc-데이터프레임-합치기" class="nav-link" data-scroll-target="#데이터프레임-합치기">2.5 데이터프레임 합치기</a></li>
  <li><a href="#join" id="toc-join" class="nav-link" data-scroll-target="#join">2.5.1 <code>join()</code></a>
  <ul class="collapse">
  <li><a href="#rbind와-cbind-행열-결합-함수" id="toc-rbind와-cbind-행열-결합-함수" class="nav-link" data-scroll-target="#rbind와-cbind-행열-결합-함수">2.5.1 <code>rbind()</code>와 <code>cbind()</code> — 행/열 결합 함수</a></li>
  </ul></li>
  <li><a href="#데이터프레임-서브세팅" id="toc-데이터프레임-서브세팅" class="nav-link" data-scroll-target="#데이터프레임-서브세팅">2.6 데이터프레임 서브세팅</a>
  <ul class="collapse">
  <li><a href="#조건에-맞는-행-추출" id="toc-조건에-맞는-행-추출" class="nav-link" data-scroll-target="#조건에-맞는-행-추출">2.6.1 조건에 맞는 행 추출</a></li>
  <li><a href="#subset-함수-사용하기" id="toc-subset-함수-사용하기" class="nav-link" data-scroll-target="#subset-함수-사용하기">2.6.2 <code>subset()</code> 함수 사용하기</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#dplyr-패키지" id="toc-dplyr-패키지" class="nav-link" data-scroll-target="#dplyr-패키지">3. <code>dplyr</code> 패키지</a>
  <ul class="collapse">
  <li><a href="#파이프-연산자" id="toc-파이프-연산자" class="nav-link" data-scroll-target="#파이프-연산자">3.1 파이프 연산자</a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select">3.2 <code>select()</code></a>
  <ul class="collapse">
  <li><a href="#주요-사용-예시" id="toc-주요-사용-예시" class="nav-link" data-scroll-target="#주요-사용-예시">주요 사용 예시</a></li>
  </ul></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter">3.3 <code>filter()</code></a>
  <ul class="collapse">
  <li><a href="#주요-사용-예시-1" id="toc-주요-사용-예시-1" class="nav-link" data-scroll-target="#주요-사용-예시-1">주요 사용 예시</a></li>
  </ul></li>
  <li><a href="#slice" id="toc-slice" class="nav-link" data-scroll-target="#slice">3.4 <code>slice()</code></a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate">3.5 <code>mutate()</code></a></li>
  <li><a href="#summarize" id="toc-summarize" class="nav-link" data-scroll-target="#summarize">3.6 <code>summarize()</code></a></li>
  <li><a href="#group_by" id="toc-group_by" class="nav-link" data-scroll-target="#group_by">3.7 <code>group_by()</code></a></li>
  <li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange">3.8 <code>arrange()</code></a></li>
  </ul></li>
  <li><a href="#ggplot2의-이해와-활용" id="toc-ggplot2의-이해와-활용" class="nav-link" data-scroll-target="#ggplot2의-이해와-활용">4. ggplot2의 이해와 활용</a>
  <ul class="collapse">
  <li><a href="#왜-ggplot2를-쓰는가" id="toc-왜-ggplot2를-쓰는가" class="nav-link" data-scroll-target="#왜-ggplot2를-쓰는가">왜 ggplot2를 쓰는가</a>
  <ul class="collapse">
  <li><a href="#기본-plot-vs-ggplot2" id="toc-기본-plot-vs-ggplot2" class="nav-link" data-scroll-target="#기본-plot-vs-ggplot2">기본 plot vs ggplot2</a></li>
  </ul></li>
  <li><a href="#강의-목표" id="toc-강의-목표" class="nav-link" data-scroll-target="#강의-목표">강의 목표</a></li>
  <li><a href="#패키지-로드와-데이터-확인" id="toc-패키지-로드와-데이터-확인" class="nav-link" data-scroll-target="#패키지-로드와-데이터-확인">4.0 패키지 로드와 데이터 확인</a></li>
  <li><a href="#ggplot2의-기본-구조" id="toc-ggplot2의-기본-구조" class="nav-link" data-scroll-target="#ggplot2의-기본-구조">4.1 ggplot2의 기본 구조</a>
  <ul class="collapse">
  <li><a href="#가장-기본-산점도" id="toc-가장-기본-산점도" class="nav-link" data-scroll-target="#가장-기본-산점도">4.1.1 가장 기본: 산점도</a></li>
  </ul></li>
  <li><a href="#미적요소aes-확장-색투명도" id="toc-미적요소aes-확장-색투명도" class="nav-link" data-scroll-target="#미적요소aes-확장-색투명도">4.2. 미적요소(aes) 확장: 색/투명도</a>
  <ul class="collapse">
  <li><a href="#범주형-변수를-색으로" id="toc-범주형-변수를-색으로" class="nav-link" data-scroll-target="#범주형-변수를-색으로">4.2.1 범주형 변수를 색으로</a></li>
  <li><a href="#점-겹침-완화-투명도alpha" id="toc-점-겹침-완화-투명도alpha" class="nav-link" data-scroll-target="#점-겹침-완화-투명도alpha">4.2.2 점 겹침 완화: 투명도(alpha)</a></li>
  </ul></li>
  <li><a href="#레이어-추가-추세선geom_smooth" id="toc-레이어-추가-추세선geom_smooth" class="nav-link" data-scroll-target="#레이어-추가-추세선geom_smooth">4.3. 레이어 추가: 추세선(geom_smooth)</a>
  <ul class="collapse">
  <li><a href="#전체-추세선비선형-스무딩" id="toc-전체-추세선비선형-스무딩" class="nav-link" data-scroll-target="#전체-추세선비선형-스무딩">4.3.1 전체 추세선(비선형 스무딩)</a></li>
  <li><a href="#선형회귀-추세선method-lm" id="toc-선형회귀-추세선method-lm" class="nav-link" data-scroll-target="#선형회귀-추세선method-lm">4.3.2 선형회귀 추세선(method = “lm”)</a></li>
  </ul></li>
  <li><a href="#facet으로-그룹-비교" id="toc-facet으로-그룹-비교" class="nav-link" data-scroll-target="#facet으로-그룹-비교">4.4. facet으로 그룹 비교</a>
  <ul class="collapse">
  <li><a href="#차종별로-나누어-보기" id="toc-차종별로-나누어-보기" class="nav-link" data-scroll-target="#차종별로-나누어-보기">4.4.1 차종별로 나누어 보기</a></li>
  <li><a href="#구동방식별로-나누어-보기" id="toc-구동방식별로-나누어-보기" class="nav-link" data-scroll-target="#구동방식별로-나누어-보기">4.4.2 구동방식별로 나누어 보기</a></li>
  </ul></li>
  <li><a href="#범주형-그래프-막대그래프-박스플롯" id="toc-범주형-그래프-막대그래프-박스플롯" class="nav-link" data-scroll-target="#범주형-그래프-막대그래프-박스플롯">4.5. 범주형 그래프: 막대그래프 / 박스플롯</a>
  <ul class="collapse">
  <li><a href="#막대그래프빈도" id="toc-막대그래프빈도" class="nav-link" data-scroll-target="#막대그래프빈도">4.5.1 막대그래프(빈도)</a></li>
  <li><a href="#박스플롯-차종별-고속도로-연비-분포" id="toc-박스플롯-차종별-고속도로-연비-분포" class="nav-link" data-scroll-target="#박스플롯-차종별-고속도로-연비-분포">4.5.2 박스플롯: 차종별 고속도로 연비 분포</a></li>
  </ul></li>
  <li><a href="#집계-후-시각화-dplyr-ggplot2" id="toc-집계-후-시각화-dplyr-ggplot2" class="nav-link" data-scroll-target="#집계-후-시각화-dplyr-ggplot2">4.6. 집계 후 시각화: dplyr + ggplot2</a>
  <ul class="collapse">
  <li><a href="#차종별-평균-hwy-계산" id="toc-차종별-평균-hwy-계산" class="nav-link" data-scroll-target="#차종별-평균-hwy-계산">4.6.1 차종별 평균 hwy 계산</a></li>
  <li><a href="#평균-연비-막대그래프geom_col" id="toc-평균-연비-막대그래프geom_col" class="nav-link" data-scroll-target="#평균-연비-막대그래프geom_col">4.6.2 평균 연비 막대그래프(geom_col)</a></li>
  <li><a href="#값-기준-정렬reorder-가독성축-뒤집기" id="toc-값-기준-정렬reorder-가독성축-뒤집기" class="nav-link" data-scroll-target="#값-기준-정렬reorder-가독성축-뒤집기">4.6.3 값 기준 정렬(reorder) + 가독성(축 뒤집기)</a></li>
  </ul></li>
  <li><a href="#라벨제목범례-설정-labs" id="toc-라벨제목범례-설정-labs" class="nav-link" data-scroll-target="#라벨제목범례-설정-labs">4.7. 라벨/제목/범례 설정: labs</a></li>
  <li><a href="#테마theme-전체-스타일-바꾸기" id="toc-테마theme-전체-스타일-바꾸기" class="nav-link" data-scroll-target="#테마theme-전체-스타일-바꾸기">4.8. 테마(theme): 전체 스타일 바꾸기</a></li>
  <li><a href="#스케일scale-축-변환범위-조정" id="toc-스케일scale-축-변환범위-조정" class="nav-link" data-scroll-target="#스케일scale-축-변환범위-조정">4.9. 스케일(scale): 축 변환/범위 조정</a>
  <ul class="collapse">
  <li><a href="#y축-범위-제한주의-범위-밖-데이터는-잘린다" id="toc-y축-범위-제한주의-범위-밖-데이터는-잘린다" class="nav-link" data-scroll-target="#y축-범위-제한주의-범위-밖-데이터는-잘린다">4.9.1 y축 범위 제한(주의: 범위 밖 데이터는 잘린다)</a></li>
  <li><a href="#로그-스케일분포가-한쪽으로-치우친-경우" id="toc-로그-스케일분포가-한쪽으로-치우친-경우" class="nav-link" data-scroll-target="#로그-스케일분포가-한쪽으로-치우친-경우">4.9.2 로그 스케일(분포가 한쪽으로 치우친 경우)</a></li>
  </ul></li>
  <li><a href="#저장하기-ggsave" id="toc-저장하기-ggsave" class="nav-link" data-scroll-target="#저장하기-ggsave">4.10. 저장하기: ggsave</a></li>
  <li><a href="#연습문제" id="toc-연습문제" class="nav-link" data-scroll-target="#연습문제">4.11. 연습문제</a>
  <ul class="collapse">
  <li><a href="#연습-1" id="toc-연습-1" class="nav-link" data-scroll-target="#연습-1">연습 1</a></li>
  <li><a href="#연습-2" id="toc-연습-2" class="nav-link" data-scroll-target="#연습-2">연습 2</a></li>
  <li><a href="#연습-3" id="toc-연습-3" class="nav-link" data-scroll-target="#연습-3">연습 3</a></li>
  </ul></li>
  <li><a href="#요약" id="toc-요약" class="nav-link" data-scroll-target="#요약">요약</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="intro_R.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">스포츠과학원 재직자교육 - R을 활용한 데이터 분석</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>서울시립대학교 빅데이터 혁신융합대학 사업단 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 21, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="패키지-로드-및-데이터-불러오기" class="level2">
<h2 class="anchored" data-anchor-id="패키지-로드-및-데이터-불러오기">패키지 로드 및 데이터 불러오기</h2>
<section id="패키지-불러오기-library" class="level3">
<h3 class="anchored" data-anchor-id="패키지-불러오기-library">패키지 불러오기 (<code>library()</code>)</h3>
<p>앞서 <code>install.packages()</code>를 통해 패키지를 설치한 것은 스마트폰에 앱을 ’다운로드’한 것과 같다. 앱을 사용하려면 아이콘을 눌러서 실행해야 하듯이, R에서도 설치된 패키지를 사용하려면 이 패키지를 사용 할 것이라 선언해 주는 과정이 필요하다.</p>
<p>이때 사용하는 함수가 <code>library()</code>이다,</p>
<ul>
<li><p><strong>설치:</strong> 컴퓨터에 한 번만 하면 됨. (인터넷 필요)</p></li>
<li><p><strong>실행:</strong> RStudio를 켤 때마다, 해당 기능을 쓰기 위해 매번 실행해야 함. (오프라인 가능)</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터를 다루는 'dplyr' 패키지 실행</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 엑셀 파일을 읽어오는 'readxl' 패키지 실행</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래프를 그리는 'ggplot2' 패키지 실행</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>현재 내 RStudio에 어떤 패키지들이 로드되어(활성화되어) 있는지 확인하려면 <code>search()</code> 함수를 사용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ".GlobalEnv"        "package:stats"     "package:graphics" 
[4] "package:grDevices" "package:utils"     "package:datasets" 
[7] "package:methods"   "Autoloads"         "package:base"     </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
주의사항
</div>
</div>
<div class="callout-body-container callout-body">
<p>R의 패키지들은 전 세계 사용자들이 자발적으로 만든 것이므로 아주 드물게 오류가 있을 수 있다는 점을 항상 염두에 두어야 한다.</p>
</div>
</div>
</section>
<section id="외부-데이터-불러오기" class="level3">
<h3 class="anchored" data-anchor-id="외부-데이터-불러오기">외부 데이터 불러오기</h3>
<p>R에서 데이터를 직접 타이핑해서 입력하는 경우는 거의 없다. 대부분 엑셀이나 회사 시스템에서 내려받은 파일을 R로 가져와서 분석하게 된다. 가장 많이 사용하는 두 가지 파일 형식인 <code>.csv</code>와 <code>.xlsx(엑셀)</code> 파일을 불러오는 방법을 알아보자.</p>
<ol type="1">
<li><p><strong>CSV 파일 불러오기</strong></p>
<p>가장 흔하게 접하게 될 파일 형식은 <code>.csv</code>이이다. CSV는 <strong>Comma Separated Values</strong>의 약자로, 겉보기엔 엑셀 파일 같지만 실제로는 데이터들이 쉼표(,)로 구분된 단순한 텍스트 파일이이다. 용량이 가볍고 호환성이 좋아 데이터 분석에서 가장 선호하는 형식이다.</p>
<p>R에서 CSV 파일을 불러올 때는 <code>read.csv()</code> 함수를 사용한다.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
파일 경로 지정 팁
</div>
</div>
<div class="callout-body-container callout-body">
<p>윈도우 탐색기에서 파일 경로를 복사하면 <code>C:\Users\Data</code> 처럼 역슬래시(<code>\</code>)로 되어 있다. R에서는 이를 인식하지 못하므로, 반드시 슬래시(<code>/</code>) 두 개(<code>\\</code>)로 바꿔주어야 한다.</p>
<ul>
<li>(X) <code>"C:\Users\Data\file.csv"</code></li>
<li>(O) <code>"C:/Users/Data/file.csv</code></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 파일 경로를 큰따옴표("") 안에 넣어주세요.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"C:/Users/Data/my_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li><p><strong>한글이 깨져서 보일 때 (인코딩 문제)</strong></p>
<p>한국인 사용자에게 가장 골치 아픈 문제이다. 파일을 불러왔는데 <code>ꍪꍫ</code> 같은 외계어가 나온다면 <strong>인코딩(Encoding)</strong> 방식이 맞지 않아서이다. 이럴 때는 <code>fileEncoding</code> 옵션을 추가한다.</p>
<ul>
<li><p><strong>CP949</strong>: 보통 윈도우 환경에서 만든 파일일 때</p></li>
<li><p><strong>UTF-8</strong>: 맥(Mac)이나 웹, 최신 시스템에서 만든 파일일 때</p></li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 윈도우 엑셀로 저장한 CSV라면 보통 CP949입니다.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"파일경로/파일명.csv"</span>, <span class="at">fileEncoding =</span> <span class="st">"CP949"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 그래도 깨진다면 UTF-8을 시도해보세요.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">"파일경로/파일명.csv"</span>, <span class="at">fileEncoding =</span> <span class="st">"UTF-8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li><p><strong>첫 번째 줄이 제목일 때 (Header)</strong></p>
<p>데이터 파일의 첫 번째 줄(행)이 변수명(칼럼명)인 경우가 많다. <code>read.csv</code>는 기본적으로 첫 줄을 제목으로 인식하지만(<code>header = TRUE</code>), 만약 첫 줄부터 바로 데이터가 시작된다면 <code>header = FALSE</code> 옵션을 주어야 한다.</p></li>
<li><p><strong>엑셀 파일(.xlsx) 불러오기</strong></p>
<p>순수 엑셀 파일(<code>.xls</code>, <code>.xlsx</code>)을 불러올 때는 R의 기본 기능으로는 안 되고, <code>readxl</code>이라는 패키지의 힘을 빌려야 한다. (위에서 <code>library(readxl)</code>을 했는지 꼭 확인!)</p>
<ul>
<li><p><code>.xls</code> 파일 (구버전 엑셀): <code>read_xls()</code> 함수 사용</p></li>
<li><p><code>.xlsx</code> 파일 (신버전 엑셀): <code>read_xlsx()</code> 함수 사용</p></li>
</ul>
<p>엑셀 파일은 여러 개의 시트(Sheet) 로 구성된 경우가 많다. 특정 시트의 데이터만 가져오고 싶다면 <code>sheet</code> 옵션에 번호나 시트 이름을 적어주면 된다.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 엑셀 파일 불러오기</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_xlsx</span>(<span class="st">"C:/Users/Data/sales_data.xlsx"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 번째 시트에 있는 데이터만 가져오고 싶을 때</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">read_xlsx</span>(<span class="st">"C:/Users/Data/sales_data.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="r의-기초" class="level1">
<h1>1. R의 기초</h1>
<section id="연산" class="level2">
<h2 class="anchored" data-anchor-id="연산">1.1 연산</h2>
<section id="기초-연산" class="level3">
<h3 class="anchored" data-anchor-id="기초-연산">1.1.1 기초 연산</h3>
<p><code>R</code>은 사칙연산(덧셈, 뺄셈, 곱셈, 나눗셈)에 대한 기본적인 기능을 제공한다.<br>
특히 곱셈 기호는 문자 <code>x</code>가 아니라 연산자 <code>*</code>를 사용한다는 점에 주의하자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="비교-연산" class="level3">
<h3 class="anchored" data-anchor-id="비교-연산">1.1.2 비교 연산</h3>
<p><code>R</code>에서는 부등호와 등호를 이용한 <strong>비교 연산</strong>이 가능하다.<br>
비교 연산자는 조건문, 필터링, 논리 판단 등에 자주 사용된다.</p>
<p>비교 연산을 수행하면 결과로 <code>TRUE</code> 또는 <code>FALSE</code>가 출력된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">&gt;</span> <span class="dv">2</span>      <span class="co"># TRUE</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">==</span> <span class="dv">10</span>    <span class="co"># FALSE</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="sc">!=</span> <span class="dv">4</span>     <span class="co"># FALSE</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="sc">&lt;=</span> <span class="dv">9</span>     <span class="co"># TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="변수" class="level2">
<h2 class="anchored" data-anchor-id="변수">1.2 변수</h2>
<section id="변수-할당" class="level3">
<h3 class="anchored" data-anchor-id="변수-할당">1.2.1 변수 할당</h3>
<p><code>R</code>에서 변수를 생성(할당)하는 방법은 여러 가지가 있지만, 그 중 <code>&lt;-</code> 또는 <code>=</code> 연산자가 가장 자주 사용된다.<br>
<code>x</code>라는 변수에 2를, <code>y</code>라는 변수에 5를 저장해보자:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="변수-이름-규칙" class="level3">
<h3 class="anchored" data-anchor-id="변수-이름-규칙">1.2.2 변수 이름 규칙</h3>
<p><code>R</code>에서 변수 이름을 정할 때는 다음과 같은 규칙이 적용된다:</p>
<ol type="1">
<li>변수 이름은 반드시 <strong>영문자 또는 마침표(<code>.</code>), 밑줄(<code>_</code>)로 시작</strong>해야 한다. 숫자로 시작할 수는 없다.</li>
<li>변수 이름에는 <strong>영문자, 숫자, 마침표(<code>.</code>), 밑줄(<code>_</code>)</strong>만 사용할 수 있다.</li>
<li><strong>공백(띄어쓰기)</strong>이나 특수문자(예: <code>@</code>, <code>!</code>, <code>-</code> 등)는 사용할 수 없다.</li>
<li>대소문자를 구분한다. (<code>score</code>와 <code>Score</code>는 다른 변수로 인식됨)</li>
<li><code>R</code>의 <strong>예약어</strong>(예: <code>if</code>, <code>for</code>, <code>TRUE</code>, <code>function</code> 등)는 변수 이름으로 사용할 수 없다.</li>
</ol>
</section>
<section id="변수-제거" class="level3">
<h3 class="anchored" data-anchor-id="변수-제거">1.2.3 변수 제거</h3>
<p>변수를 제거하려면 <code>rm()</code> 함수를 사용한다.<br>
삭제하고자 하는 변수명을 <code>rm()</code> 함수 안에 넣어주면 해당 변수가 메모리에서 제거된다.</p>
<ul>
<li><code>ls()</code>: 현재 작업 환경에 저장되어 있는 변수들의 이름을 나열해준다.</li>
<li><code>rm()</code>: 변수를 삭제한다. 삭제하려는 변수의 이름을 <code>rm()</code> 함수 안에 넣어 실행하면 된다. 예: <code>rm(x)</code>는 변수 <code>x</code>를 삭제한다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)   <span class="co"># 변수 x 제거</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="데이터타입" class="level2">
<h2 class="anchored" data-anchor-id="데이터타입">1.3 데이터타입</h2>
<p><code>R</code>에서 사용되는 데이터 타입은 매우 다양하지만, 그중에서도 네 가지 주요 데이터 타입이 자주 사용된다:<br>
<code>numeric</code>, <code>character</code>, <code>logical</code>, <code>Date/POSIXct</code></p>
<p>이번 교육에서는 이 중에서 <code>numeric</code>, <code>character</code>, <code>logical</code> 세 가지 타입을 중심으로 다루도록 하겠다.</p>
</section>
<section id="numeric-자료" class="level2">
<h2 class="anchored" data-anchor-id="numeric-자료">1.3.1 <code>numeric</code> 자료</h2>
<p><code>R</code>은 대다수의 자료가 숫자형태로 존재하게 된다. <code>numeric</code> 자료는 정수, 실수를 다루며 어떤 변수가 <code>numeric</code>인지 확인하는 함수는 <code>is.numeric()</code>을 통해 이루어진다.</p>
<p><code>R</code>에서는 대부분의 데이터가 숫자 형태로 표현되며, 이러한 데이터를 <code>numeric</code> 타입이라고 한다.<br>
<code>numeric</code> 자료형은 <strong>정수(integer)</strong>와 <strong>실수(double)</strong>를 모두 포함한다.</p>
<p>어떤 변수가 <code>numeric</code> 타입인지 확인하려면 <code>is.numeric()</code> 함수를 사용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fl">3.14</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(x)   <span class="co"># TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>정수를 생성하고 싶은 경우, 숫자 뒤에 <code>L</code>을 붙이면 해당 변수를 <strong>정수(integer)</strong>로 생성할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span>L</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.integer</span>(x)   <span class="co"># TRUE</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(x)   <span class="co"># TRUE (정수도 numeric의 하위 개념)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>어떤 변수의 데이터타입을 알고 싶은 경우 <code>class()</code> 함수를 통하면 알 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fl">3.14</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)    <span class="co"># "numeric"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="character-자료" class="level2">
<h2 class="anchored" data-anchor-id="character-자료">1.3.2 <code>character</code> 자료</h2>
<p><code>R</code>에서 <code>character</code>(문자형)는 <code>numeric</code>만큼이나 자주 사용되는 데이터 타입이다.<br>
문자형 데이터는 텍스트, 범주형 값, 이름 등의 정보를 저장할 때 사용된다.</p>
<p><code>R</code>에서는 문자형 데이터를 다루는 방식이 두 가지로 구분된다:<br>
하나는 일반적인 문자열 자료인 <code>character</code> 타입이고, 다른 하나는 범주형 데이터를 위한 <code>factor</code> 타입이다.</p>
<ul>
<li><code>character</code>: 단순한 문자열 데이터 (예: 이름, 도시명 등)</li>
<li><code>factor</code>: 고정된 수준(level)을 갖는 범주형 데이터 (예: 성별, 지역구분 등)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> <span class="st">"Alice"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(name)       <span class="co"># "character"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="st">"female"</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(gender)     <span class="co"># "factor"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="logical-자료" class="level2">
<h2 class="anchored" data-anchor-id="logical-자료">1.3.3 <code>logical</code> 자료</h2>
<p><code>R</code>에서 <code>logical</code>(논리형)은 참(<code>TRUE</code>) 또는 거짓(<code>FALSE</code>)의 값을 표현하는 데이터 타입이다. 조건문, 필터링, 비교 연산의 결과 등에서 매우 자주 사용된다.</p>
<p>논리형 데이터는 다음과 같이 직접 생성할 수 있다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(a)   <span class="co"># "logical"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>또한, 비교 연산 결과는 항상 <code>logical</code> 값을 반환한다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&gt;</span> <span class="dv">3</span>      <span class="co"># TRUE</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">==</span> <span class="dv">10</span>    <span class="co"># FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>logical</code> 값은 숫자 연산과도 호환되며, <code>TRUE</code>는 1, <code>FALSE</code>는 0으로 간주되어 계산에 활용될 수 있다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">+</span> <span class="cn">TRUE</span>    <span class="co"># 2</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">*</span> <span class="dv">5</span> <span class="co"># 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="벡터-vector" class="level3">
<h3 class="anchored" data-anchor-id="벡터-vector">1.4 벡터 (Vector)</h3>
<p><code>R</code>에서 가장 기본적인 데이터 구조는 <strong>벡터</strong>이다.<br>
벡터는 <strong>동일한 데이터 타입을 갖는 값들의 모음</strong>으로, 숫자형, 문자형, 논리형 등 다양한 타입의 벡터를 생성할 수 있다.</p>
<p>벡터를 만드는 가장 일반적인 방법은 <code>c()</code> 함수를 사용하는 것이다.<br>
<code>c()</code>는 “combine”의 약자로 여러 값을 하나의 벡터로 결합해준다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 숫자형 벡터</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>num_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 문자형 벡터</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>char_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 논리형 벡터</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>log_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>벡터는 <strong>동일한 데이터 타입</strong>만 저장할 수 있는 자료구조이다.<br>
서로 다른 타입의 값을 함께 넣으면 <code>R</code>은 자동으로 <strong>가장 일반적인 타입</strong>으로 변환(coercion)하여 벡터를 생성한다.</p>
<p>예를 들어, 다음과 같은 벡터에는 세 가지 타입(숫자형, 문자형, 논리형)이 혼합되어 있으므로 문자형을 반환한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">"김"</span>, <span class="cn">TRUE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(v)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 출력: "1" "2" "김" "TRUE"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(v)    <span class="co"># "character"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="벡터-연산" class="level3">
<h3 class="anchored" data-anchor-id="벡터-연산">1.4.1 벡터 연산</h3>
<p><code>R</code>에서는 벡터 간의 연산이 <strong>원소별(element-wise)</strong>로 자동 수행된다.<br>
벡터 연산은 <code>R</code>의 강력한 기능 중 하나로, 복잡한 반복문 없이도 간결하게 계산을 처리할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> b   <span class="co"># 각 위치의 값끼리 더함: 1+4, 2+5, 3+6 → 5 7 9</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>a <span class="sc">-</span> b   <span class="co"># -3 -3 -3</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>a <span class="sc">*</span> b   <span class="co"># 4 10 18</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>a <span class="sc">/</span> b   <span class="co"># 0.25 0.4 0.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>벡터는 스칼라 값과도 연산이 가능하며, 각 원소에 동일한 연산이 적용된다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> <span class="dv">10</span>     <span class="co"># 11 12 13</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>a <span class="sc">*</span> <span class="dv">2</span>      <span class="co"># 2 4 6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>두 벡터의 길이가 다르면, 짧은 쪽 벡터의 값을 자동으로 반복하여 연산한다. 이를 <strong>재활용 규칙(recycling rule)</strong>이라고 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>a <span class="sc">+</span> b     <span class="co"># 1+10, 2+100, 3+10, 4+100 → 11 102 13 104</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="벡터-인덱싱" class="level3">
<h3 class="anchored" data-anchor-id="벡터-인덱싱">1.4.2 벡터 인덱싱</h3>
<p><code>R</code>에서 벡터의 특정 요소에 접근하거나 일부 값을 선택하기 위해 <strong>인덱싱</strong>을 사용할 수 있다.<br>
<code>R</code>의 인덱스는 <strong>1부터 시작</strong>한다는 점에 주의해야 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]       <span class="co"># 첫 번째 요소 10</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">3</span>]       <span class="co"># 세 번째 요소 30</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)] <span class="co"># 두 번째와 네 번째 요소 20 4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>음수를 사용하면 해당 위치의 요소를 제외할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="dv">1</span>]      <span class="co"># 첫 번째 요소 제외 20 30 40 50</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>)]<span class="co"># 2번째와 5번째 제외 10 30 40</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>TRUE</code>/<code>FALSE</code> 값을 이용해 원하는 요소만 선택할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">&gt;</span> <span class="dv">10</span>          <span class="co"># FALSE FALSE TRUE TRUE</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>x[x <span class="sc">&gt;</span> <span class="dv">10</span>]       <span class="co"># 조건을 만족하는 값만 → 15 20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>벡터에 <code>이름(names)</code> 을 지정하면, 이름을 통해 인덱싱할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">100</span>, <span class="at">b =</span> <span class="dv">200</span>, <span class="at">c =</span> <span class="dv">300</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>x[<span class="st">"b"</span>]         <span class="co"># 200</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x)       <span class="co"># "a" "b" "c"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="범주형-벡터-factor-vector" class="level3">
<h3 class="anchored" data-anchor-id="범주형-벡터-factor-vector">1.4.3 범주형 벡터 (<code>factor</code> vector)</h3>
<p><code>R</code>에서는 <strong>범주형(categorical)</strong> 데이터를 표현할 때 <code>factor</code> 벡터를 사용한다.<br>
<code>factor</code>는 문자형 데이터처럼 보이지만, 내부적으로는 <strong>고정된 수준(level)</strong>을 가지는 <strong>정수형 벡터</strong>로 처리된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(gender)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>gender</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 출력: [1] male   female male   female female</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Levels: female male</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="벡터-관련-주요함수" class="level3">
<h3 class="anchored" data-anchor-id="벡터-관련-주요함수">1.4.4 벡터 관련 주요함수</h3>
<p><code>R</code>에서는 벡터를 다루기 위해 다양한 기본 함수들이 제공된다.<br>
아래는 자주 사용되는 대표적인 벡터 함수들이다.</p>
<p><code>length()</code> — 벡터의 길이(요소 개수) 반환</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(x)   <span class="co"># 4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>sum()</code> — 모든 요소의 합계 계산</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)      <span class="co"># 100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>mean()</code> — 평균값 계산</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)     <span class="co"># 25</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>max()</code> / <code>min()</code> — 최대값 / 최소값</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(x)      <span class="co"># 40</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(x)      <span class="co"># 10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>sort()</code> - 정렬</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x)           <span class="co"># 오름차순 10 20 30 40</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)  <span class="co"># 내림차순 40 30 20 10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="na-vs-null" class="level3">
<h3 class="anchored" data-anchor-id="na-vs-null">1.4.5 NA vs NULL</h3>
<p><code>R</code>에서 결측값(빠진 데이터)을 표현할 때는 주로 <code>NA</code>와 <code>NULL</code>이 사용된다.<br>
이 둘은 비슷해 보이지만 의미와 동작이 <strong>완전히 다르다</strong>.</p>
<p><code>NA</code> (Not Available)</p>
<ul>
<li><strong>결측값(missing value)</strong>을 의미</li>
<li>벡터나 데이터프레임 내에서 <strong>값은 존재하지만 비어 있음</strong></li>
<li>수치 연산 또는 통계 처리 대상에 포함됨</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)                <span class="co"># NA (결측이 포함되면 결과도 NA)</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># 2.33 (결측값 무시하고 계산)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>NULL</code></p>
<ul>
<li>존재 자체가 없음</li>
<li>길이가 0이고, 연산 대상에도 포함되지 않음</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(y)     <span class="co"># 0</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NULL</span>, <span class="dv">3</span>)   <span class="co"># NULL은 무시됨 c(1, 3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="데이터-프레임-i" class="level1">
<h1>2. 데이터 프레임 I</h1>
<p><code>data.frame</code>은 <code>R</code>에서 가장 많이 사용되는 데이터 구조 중 하나로, <strong>여러 개의 벡터(열)를 같은 길이로 묶어 2차원 형태의 표 형식 데이터</strong>로 만든 것이다.</p>
<p>엑셀의 시트처럼 <strong>행(row)</strong>과 <strong>열(column)</strong>로 구성되어 있으며, 각 열은 서로 다른 타입(<code>numeric</code>, <code>character</code>, <code>logical</code> 등)을 가질 수 있다.</p>
<p>아래 그림을 보자. 데이터프레임에서 <strong>열(column)</strong>은 각각 하나의 <strong>변수(variable)</strong>를 나타내고, <strong>행(row)</strong>은 각 변수에 대한 하나의 <strong>관측치(observation)</strong>를 의미한다.</p>
<div id="fig-data1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-data1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: 데이터프레임의 구조
</figcaption>
<div aria-describedby="fig-data1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/tidy.png" class="img-fluid figure-img" style="width:80.0%">
</div>
</figure>
</div>
<p>R의 문법을 익히는 가장 효과적인 방법은 실제 데이터를 직접 다뤄보는 것이다. 이번 교육 과정에서는 <code>ggplot2</code> 패키지에 내장된 <code>mpg</code> 데이터 를 활용하여 실습을 진행한다.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>mpg</code> 데이터 설명
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>mpg</code> 데이터는 미국 환경 보호국(US EPA)에서 공개한 자료로, 1999년부터 2008년까지 출시된 자동차 234종의 연비 정보를 담고 있다. 일반적인 엑셀 표와 같이 행(Row)과 열(Column)로 구성된 데이터프레임 형태이다. 별도로 파일을 다운로드할 필요 없이 <code>ggplot2</code> 패키지만 로드하면 즉시 사용할 수 있어 연습용 데이터로 널리 사용된다.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>mpg</code> 데이터의 각 열(Column)이 의미하는 바는 다음과 같다.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td>변수명</td>
<td>설명</td>
<td>예시</td>
</tr>
<tr class="even">
<td><strong>manufacturer</strong></td>
<td>제조사</td>
<td>audi, hyundai, jeep 등</td>
</tr>
<tr class="odd">
<td><strong>model</strong></td>
<td>모델명</td>
<td>a4, sonata 등</td>
</tr>
<tr class="even">
<td><strong>displ</strong></td>
<td>배기량 (엔진 크기)</td>
<td>숫자가 클수록 배기량이 큼 (예: 1.8, 2.0)</td>
</tr>
<tr class="odd">
<td><strong>year</strong></td>
<td>생산연도</td>
<td>1999, 2008</td>
</tr>
<tr class="even">
<td><strong>cyl</strong></td>
<td>실린더 개수 (기통)</td>
<td>4기통, 6기통 등</td>
</tr>
<tr class="odd">
<td><strong>trans</strong></td>
<td>변속기 종류</td>
<td>auto(자동), manual(수동)</td>
</tr>
<tr class="even">
<td><strong>drv</strong></td>
<td>구동 방식</td>
<td>f(전륜), r(후륜), 4(4륜)</td>
</tr>
<tr class="odd">
<td><strong>cty</strong></td>
<td><strong>도심 연비</strong> (City MPG)</td>
<td>도심 주행 시 연비 (단위: 마일/갤런)</td>
</tr>
<tr class="even">
<td><strong>hwy</strong></td>
<td><strong>고속도로 연비</strong> (Highway MPG)</td>
<td>고속도로 주행 시 연비 (단위: 마일/갤런)</td>
</tr>
<tr class="odd">
<td><strong>fl</strong></td>
<td>연료 종류</td>
<td>p(프리미엄), r(레귤러), e(에탄올) 등</td>
</tr>
<tr class="even">
<td><strong>class</strong></td>
<td>자동차 종류</td>
<td>compact(소형), suv, minivan 등</td>
</tr>
</tbody>
</table>
<section id="데이터-프레임의-생성" class="level2">
<h2 class="anchored" data-anchor-id="데이터-프레임의-생성">2.1 데이터 프레임의 생성</h2>
<p><code>R</code>에서 데이터프레임을 생성하는 방법은 여러 가지가 있지만,<br>
그 중 가장 간단한 방법은 <code>data.frame()</code> 함수를 사용하는 것이다.</p>
<p>이제 세 개의 벡터 <code>x</code>, <code>y</code>, <code>q</code>를 만들어 데이터프레임으로 결합해보자:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Hockey"</span>, <span class="st">"Football"</span>, <span class="st">"Baseball"</span>, <span class="st">"Curling"</span>, <span class="st">"Rugby"</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">"Lacrosse"</span>, <span class="st">"Basketball"</span>, <span class="st">"Tennis"</span>, <span class="st">"Cricket"</span>, <span class="st">"Soccer"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y, q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터프레임의 각 열(column)에 이름을 붙이고 싶을 경우,<br>
<code>data.frame()</code> 함수에서 <strong>이름 = 벡터</strong> 형식으로 지정하면 된다.</p>
<p>예를 들어 <code>x</code>, <code>y</code>, <code>q</code> 벡터를 각각 <code>"First"</code>, <code>"Second"</code>, <code>"Sport"</code>라는 이름으로 지정하려면 다음과 같이 작성한다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Fisrt =</span> x, <span class="at">Second =</span> y, <span class="at">Sport =</span> q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="데이터프레임-정보-요약하기" class="level2">
<h2 class="anchored" data-anchor-id="데이터프레임-정보-요약하기">2.2 데이터프레임 정보 요약하기</h2>
<section id="nrow-ncol-그리고-dim" class="level3">
<h3 class="anchored" data-anchor-id="nrow-ncol-그리고-dim">2.2.1 <code>nrow()</code>, <code>ncol()</code> 그리고 <code>dim()</code></h3>
<p>데이터프레임을 다루다 보면 <strong>행과 열의 개수</strong>를 알아야 할 일이 자주 있다.<br>
이럴 때 사용하는 함수가 바로 <code>nrow()</code>, <code>ncol()</code>, 그리고 <code>dim()</code> 함수이다.</p>
<ul>
<li><code>nrow()</code>는 행(row)의 개수를 반환한다.</li>
<li><code>ncol()</code>은 열(column)의 개수를 반환한다.</li>
<li><code>dim()</code>은 행과 열의 개수를 <strong>벡터 형태</strong>로 함께 반환한다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mpg)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(mpg)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="names" class="level3">
<h3 class="anchored" data-anchor-id="names">2.2.2 <code>names()</code></h3>
<p>데이터프레임의 <strong>열 이름(column names)</strong>을 알고 싶을 경우, 가장 간단한 방법은 <code>names()</code> 함수를 사용하는 것이다.</p>
<p>이 함수는 데이터프레임의 열 이름을 <strong>문자형 벡터 형태</strong>로 반환한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="str" class="level3">
<h3 class="anchored" data-anchor-id="str">2.2.3 <code>str()</code></h3>
<p><code>str()</code> 함수는 <strong>structure(구조)</strong>의 줄임말로,데이터 객체의 <strong>전체 구조를 요약해서 보여주는 함수</strong>이다.<br>
특히 데이터프레임이나 리스트처럼 복잡한 구조를 빠르게 파악할 때 유용하다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="head-그리고-tail" class="level3">
<h3 class="anchored" data-anchor-id="head-그리고-tail">2.2.4 <code>head()</code> 그리고 <code>tail()</code></h3>
<p>데이터프레임의 전체 내용을 한눈에 보기에는 행이 너무 많을 수 있다.<br>
이럴 때는 <code>head()</code>와 <code>tail()</code> 함수를 사용하여 <strong>앞부분 또는 뒷부분 일부만 미리 확인</strong>할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpg)         <span class="co"># 기본값: 앞 6행 출력</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpg, <span class="dv">3</span>)      <span class="co"># 앞 3행 출력</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(mpg)         <span class="co"># 기본값: 뒤 6행 출력</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(mpg, <span class="dv">4</span>)      <span class="co"># 뒤 4행 출력</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>View()</code> 함수는 데이터를 엑셀처럼 새 창으로 표시하는 함수이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="변수선택-연산자" class="level3">
<h3 class="anchored" data-anchor-id="변수선택-연산자">2.2.5 변수선택 (<code>$</code> 연산자)</h3>
<p>데이터 프레임은 여러 개의 변수(열)가 모여 있는 형태이다. 분석을 하다 보면 전체 데이터가 아니라, “도심 연비(<code>cty</code>)의 평균만 구하고 싶다”거나 “고속도로 연비(<code>hwy</code>)만 따로 보고 싶다”는 등 특정 변수 하나만 필요할 때가 많다.</p>
<p>이때 사용하는 것이 바로 달러 기호(<code>$</code>)이다. <code>$</code> 연산자는 데이터 프레임 안에 있는 특정 변수(열)에 접근하는 역할을 한다.</p>
<p>작성 방식은 매우 간단하다. 데이터 프레임 이름 뒤에 <code>$</code>를 붙이고, 그 뒤에 원하는 변수명을 적으면 된다.</p>
<ul>
<li><p>형식: <code>데이터프레임명$변수명</code></p></li>
<li><p>의미: “<strong>데이터프레임</strong> 안에 있는(<strong>$</strong>) <strong>변수</strong>를 꺼내라”</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpg<span class="sc">$</span>cty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="데이터프레임-주요-함수" class="level2">
<h2 class="anchored" data-anchor-id="데이터프레임-주요-함수">2.3 데이터프레임 주요 함수</h2>
<section id="table-함수" class="level3">
<h3 class="anchored" data-anchor-id="table-함수">2.3.1 <code>table()</code> 함수</h3>
<p><code>table()</code> 함수는 함수는 범주형 변수의 <strong>값의 개수(빈도수)</strong>를 계산해주는 함수이다. <code>mpg</code>에서 <code>manufacturer</code>의 빈도</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mpg<span class="sc">$</span>manufacturer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="colsums와-colmeans" class="level3">
<h3 class="anchored" data-anchor-id="colsums와-colmeans">2.3.2 <code>colSums()</code>와 <code>colMeans()</code></h3>
<p><code>colSums()</code>와 <code>colMeans()</code>는 각각 데이터프레임의 <strong>각 열(column)</strong>에 대해<br>
<strong>합계(sum)</strong>와 <strong>평균(mean)</strong>을 계산해주는 함수이다.</p>
<p>이 함수들은 <strong>수치형(numeric)</strong> 열에만 적용되며, <strong>문자형 열이 포함된 경우 오류메세지가 나온다.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(mpg) </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">2.3.3 <code>summary()</code></h3>
<p><code>summary()</code>함수는 데이터프레임 또는 벡터의 <strong>각 변수(열)</strong>에 대한<br>
요약 통계 정보를 빠르게 확인할 수 있는 함수이다.</p>
<ul>
<li>최소값 (<code>Min.</code>)</li>
<li>1사분위수 (<code>1st Qu.</code>)</li>
<li>중앙값 (<code>Median</code>)</li>
<li>평균 (<code>Mean</code>)</li>
<li>3사분위수 (<code>3rd Qu.</code>)</li>
<li>최대값 (<code>Max.</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="데이터프레임-인덱싱" class="level2">
<h2 class="anchored" data-anchor-id="데이터프레임-인덱싱">2.4 데이터프레임 인덱싱</h2>
<p>벡터와 마찬가지로, <strong>데이터프레임도 인덱싱을 통해 원하는 값에 접근하거나 추출</strong>할 수 있다.<br>
이때 자주 사용하는 연산자가 <code>[]</code>이다.</p>
<section id="연산자---행과-열-모두-인덱싱가능" class="level3">
<h3 class="anchored" data-anchor-id="연산자---행과-열-모두-인덱싱가능">2.4.1 <code>[]</code> 연산자 - 행과 열 모두 인덱싱가능</h3>
<p><code>[i, j]</code> 형태의 대괄호 인덱싱에서 <code>i</code>는 <strong>행 번호</strong>, <code>j</code>는 <strong>열 번호</strong>를 나타낸다.<br>
따라서 특정 위치의 값을 추출하고 싶을 때 이 형식을 사용할 수 있다.</p>
<p>예를 들어, <strong>2행 3열</strong>에 있는 데이터에 접근하고 싶다면 다음과 같이 작성한다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mpg[<span class="dv">2</span>, <span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>1개 이상의 열 또는 행</strong>을 선택하고 싶을 때는 <strong>벡터 인덱싱</strong>을 사용할 수 있다.<br>
<code>:</code> 연산자나 <code>c()</code> 함수를 이용하여 원하는 범위를 지정할 수 있다.</p>
<p>예를 들어, <strong>3행의 2~3열</strong>을 선택하고 싶다면 다음과 같이 작성한다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>mpg[<span class="dv">3</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>mpg[<span class="dv">3</span>, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터프레임에서 열을 추출하고자 할 때는 <code>[ , j]</code> 형식을 사용하며,<br>
이때 <code>j</code> 자리에는 <strong>열의 위치(숫자)</strong> 또는 <strong>열의 이름(문자열)</strong>을 넣을 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mpg[, <span class="dv">3</span>]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>mpg[, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>mpg[, <span class="fu">c</span>(<span class="st">"model"</span>, <span class="st">"displ"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>[]</code> 형태의 인덱싱에서는 논리연산 결과를 이용한 조건 인덱싱이 가능하다. 이때 <code>TRUE</code>인 위치의 값만 추출되며, <code>FALSE</code>인 위치의 값은 제외된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>mpg<span class="sc">$</span>model <span class="sc">==</span> <span class="st">"a4"</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>mpg[mpg<span class="sc">$</span>model <span class="sc">==</span> <span class="st">"a4"</span>, ] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터프레임의 변수에 접근하고자 하는경우 행렬을 다룰 때와 마찬가지로 벡터 인덱싱을 사용하거나 데이터프레임 뒤에 <code>$</code>를 붙이고 변수 이름을 작성하는 방법도 있다.</p>
<ul>
<li>인덱싱을 사용하는 경우</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mpg[, <span class="dv">1</span>]</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>mpg[, <span class="st">"manufacturer"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>$</code>를 사용하는 경우</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mpg<span class="sc">$</span>manufacturer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>지금의 예제에서 둘은 같은 결과를 보여주지만 특정 상황에서는 인덱싱을 사용하거나 <code>$</code>를 사용할 수 밖에 없는 상황이 존재하니 두 방법 모두 익혀두자.</p>
<p><code>str()</code> 함수는 데이터프레임에 있는 변수들의 객체 유형과 관측치 개수를 파악하는 유용한 함수이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="복합조건-인덱싱-and-or" class="level3">
<h3 class="anchored" data-anchor-id="복합조건-인덱싱-and-or">2.4.2 복합조건 인덱싱 (and, or)</h3>
<p>두 가지 이상의 조건을 연결해야 할 때는 논리 연산자를 사용한다.</p>
<ul>
<li><p><strong>AND 연산자 (<code>&amp;</code>)</strong>: 두 조건이 <strong>모두</strong> 참이어야 할 때</p></li>
<li><p><strong>OR 연산자 (<code>|</code>)</strong>: 두 조건 중 <strong>하나라도</strong> 참이면 될 때 (<code>Shift</code> + <code>\</code> 키)</p></li>
</ul>
<ol type="1">
<li><p><strong>AND 조건 예시 (<code>&amp;</code>):</strong> 제조사가 “audi”이면서(<strong>그리고</strong>), 연비(cty)가 20 이상인 데이터를 추출하고 싶을 때 사용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manufacturer가 "audi"이고, cty가 20 이상인 행 추출</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>mpg[mpg<span class="sc">$</span>manufacturer <span class="sc">==</span> <span class="st">"audi"</span> <span class="sc">&amp;</span> mpg<span class="sc">$</span>cty <span class="sc">&gt;=</span> <span class="dv">20</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p><strong>OR 조건 예시 (<code>|</code>)</strong> 차종(class)이 “compact”이거나(<strong>또는</strong>), “midsize”인 데이터를 추출하고 싶을 때 사용한다.</p></li>
</ol>
<pre><code>::: {.cell}

```{.r .cell-code}
# class가 "compact" 또는 "midsize"인 행 추출
mpg[mpg$class == "compact" | mpg$class == "midsize", ]
```
:::</code></pre>
<ol start="3" type="1">
<li><p><strong>행 조건과 열 조건의 결합</strong></p>
<p>마지막으로, 복합 조건으로 행을 걸러냄과 동시에 보고 싶은 열만 선택하는 방법이다. <code>[행 조건, 열 선택]</code> 형식을 그대로 따르면 된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># audi 차량 중(행 조건)에서 model과 year 변수만(열 선택) 확인</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mpg[mpg<span class="sc">$</span>manufacturer <span class="sc">==</span> <span class="st">"audi"</span>, <span class="fu">c</span>(<span class="st">"model"</span>, <span class="st">"year"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
</section>
<section id="예제" class="level3">
<h3 class="anchored" data-anchor-id="예제">2.5 예제</h3>
<p>데이터 분석의 핵심은 “내가 원하는 데이터만 뽑아내서(Indexing), 그 특성을 요약(Statistics)하는 것”이다. 다음 5가지 예제를 통해 이 과정을 연습해 보자.</p>
<section id="예제-1-특정-제조사-자동차의-연비-평균-구하기" class="level4">
<h4 class="anchored" data-anchor-id="예제-1-특정-제조사-자동차의-연비-평균-구하기">예제 1: 특정 제조사 자동차의 연비 평균 구하기</h4>
<p>“<strong>Audi</strong>에서 만든 자동차들의 <strong>도심 연비(cty)</strong> 평균은 얼마일까?”</p>
<ol type="1">
<li><p>행 조건: <code>manufacturer</code>가 “audi”인 데이터</p></li>
<li><p>열 선택: <code>cty</code> (도심 연비)</p></li>
<li><p>함수: <code>mean()</code> (평균)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1단계: audi 차량만 추출하여 audi_cars 변수에 저장</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>audi_cars <span class="ot">&lt;-</span> mpg[mpg<span class="sc">$</span>manufacturer <span class="sc">==</span> <span class="st">"audi"</span>, ]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2단계: 추출된 데이터에서 cty 변수의 평균 계산</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(audi_cars<span class="sc">$</span>cty)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (심화) 한 줄로 작성하기</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mpg[mpg<span class="sc">$</span>manufacturer <span class="sc">==</span> <span class="st">"audi"</span>, <span class="st">"cty"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="예제-2-두-차종-간의-고속도로-연비-비교하기" class="level4">
<h4 class="anchored" data-anchor-id="예제-2-두-차종-간의-고속도로-연비-비교하기">예제 2: 두 차종 간의 고속도로 연비 비교하기</h4>
<p>“<strong>SUV</strong> 차량과 <strong>Compact(경차/소형)</strong> 차량 중 누가 고속도로 연비가 더 좋을까?”</p>
<ol type="1">
<li><p>행 조건: <code>class</code>가 “suv”인 것 vs “compact”인 것</p></li>
<li><p>열 선택: <code>hwy</code> (고속도로 연비)</p></li>
<li><p>함수: <code>mean()</code> (평균)으로 비교</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SUV 차량의 고속도로 연비 평균</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>suv_hwy <span class="ot">&lt;-</span> mpg[mpg<span class="sc">$</span>class <span class="sc">==</span> <span class="st">"suv"</span>, <span class="st">"hwy"</span>]</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(suv_hwy)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compact 차량의 고속도로 연비 평균</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>compact_hwy <span class="ot">&lt;-</span> mpg[mpg<span class="sc">$</span>class <span class="sc">==</span> <span class="st">"compact"</span>, <span class="st">"hwy"</span>]</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(compact_hwy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>결과를 비교해보면 일반적으로 Compact 차량의 연비가 훨씬 높게 나옵니다.</p>
</section>
<section id="예제-3-복합-조건and-데이터의-요약-통계-보기" class="level4">
<h4 class="anchored" data-anchor-id="예제-3-복합-조건and-데이터의-요약-통계-보기">예제 3: 복합 조건(AND) 데이터의 요약 통계 보기</h4>
<p>“2000년 이후에 생산된 차량 중, <strong>배기량(displ)이 4.0 이상</strong>인 대형차들의 연비 분포는 어떠한가?”</p>
<ol type="1">
<li><p>행 조건: <code>year &gt;= 2000</code> <strong>그리고(&amp;)</strong> <code>displ &gt;= 4.0</code></p></li>
<li><p>열 선택: <code>cty</code> (도심 연비)</p></li>
<li><p>함수: <code>summary()</code> (최소, 최대, 평균, 중위수 등 전체 요약)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 조건에 맞는 데이터를 big_engine_cars에 저장</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>big_engine_cars <span class="ot">&lt;-</span> mpg[mpg<span class="sc">$</span>year <span class="sc">&gt;=</span> <span class="dv">2000</span> <span class="sc">&amp;</span> mpg<span class="sc">$</span>displ <span class="sc">&gt;=</span> <span class="fl">4.0</span>, ]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 해당 차량들의 도심 연비 요약 통계 확인</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(big_engine_cars<span class="sc">$</span>cty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="예제-4-복합-조건or-데이터의-개수-세기" class="level4">
<h4 class="anchored" data-anchor-id="예제-4-복합-조건or-데이터의-개수-세기">예제 4: 복합 조건(OR) 데이터의 개수 세기</h4>
<p>“제조사가 <strong>Chevrolet</strong>이거나 <strong>Ford</strong>인 미국 자동차는 이 데이터에 총 몇 대가 있을까?”</p>
<ol type="1">
<li><p>행 조건: <code>manufacturer == "chevrolet"</code> <strong>또는(|)</strong> <code>manufacturer == "ford"</code></p></li>
<li><p>함수: <code>nrow()</code> (행의 개수) 또는 <code>table()</code> (빈도표)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 쉐보레 또는 포드 자동차 추출</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>us_cars <span class="ot">&lt;-</span> mpg[mpg<span class="sc">$</span>manufacturer <span class="sc">==</span> <span class="st">"chevrolet"</span> <span class="sc">|</span> mpg<span class="sc">$</span>manufacturer <span class="sc">==</span> <span class="st">"ford"</span>, ]</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 전체 개수(행의 수) 확인</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(us_cars)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (심화) 제조사별로 몇 대씩인지 나누어 보기</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(us_cars<span class="sc">$</span>manufacturer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="예제-5-특정-조건-데이터의-최댓값-찾기" class="level4">
<h4 class="anchored" data-anchor-id="예제-5-특정-조건-데이터의-최댓값-찾기">예제 5: 특정 조건 데이터의 최댓값 찾기</h4>
<p>“<strong>4기통(cyl == 4)</strong> 차량 중에서 가장 높은 고속도로 연비(hwy)는 얼마인가?”</p>
<ol type="1">
<li><p>행 조건: <code>cyl</code>이 4인 데이터</p></li>
<li><p>열 선택: <code>hwy</code> (고속도로 연비)</p></li>
<li><p>함수: <code>max()</code> (최댓값)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4기통 차량 데이터만 먼저 추출</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>cyl4_cars <span class="ot">&lt;-</span> mpg[mpg<span class="sc">$</span>cyl <span class="sc">==</span> <span class="dv">4</span>, ]</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 그 중에서 고속도로 연비 최댓값 확인</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(cyl4_cars<span class="sc">$</span>hwy)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (참고) 최솟값은 min() 함수 사용</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(cyl4_cars<span class="sc">$</span>hwy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="데이터프레임-합치기" class="level2">
<h2 class="anchored" data-anchor-id="데이터프레임-합치기">2.5 데이터프레임 합치기</h2>
</section>
<section id="join" class="level2">
<h2 class="anchored" data-anchor-id="join">2.5.1 <code>join()</code></h2>
<p>데이터 분석을 하다 보면 <strong>두 개 이상의 데이터프레임을 특정 기준(key)</strong>을 기준으로<br>
결합해야 하는 경우가 많다. 이때 사용하는 함수가 바로 <code>join()</code>이다.</p>
<p><code>join()</code> 함수는 기본적으로 <strong>공통된 열(기준 변수)</strong>을 기준으로 두 데이터프레임을 병합하며,<br>
<code>dplyr</code> 패키지에서 제공하는 다양한 종류의 <code>join</code> 함수들이 자주 사용된다.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>함수</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>inner_join()</code></td>
<td>양쪽 모두에 존재하는 행만 결합 (교집합)</td>
</tr>
<tr class="even">
<td><code>left_join()</code></td>
<td>왼쪽 데이터프레임 기준, 오른쪽 값이 없으면 <code>NA</code></td>
</tr>
<tr class="odd">
<td><code>right_join()</code></td>
<td>오른쪽 데이터프레임 기준, 왼쪽 값이 없으면 <code>NA</code></td>
</tr>
<tr class="even">
<td><code>full_join()</code></td>
<td>양쪽 모든 행을 결합 (합집합), 없는 값은 <code>NA</code>로 채움</td>
</tr>
</tbody>
</table>
<div id="fig-data2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-data2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Inner Join
</figcaption>
<div aria-describedby="fig-data2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/inner_join.png" class="img-fluid figure-img" style="width:40.0%">
</div>
</figure>
</div>
<div id="fig-data3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-data3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Left Join
</figcaption>
<div aria-describedby="fig-data3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/left_join.png" class="img-fluid figure-img" style="width:40.0%">
</div>
</figure>
</div>
<div id="fig-data4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-data4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Right Join
</figcaption>
<div aria-describedby="fig-data4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/right_join.png" class="img-fluid figure-img" style="width:40.0%">
</div>
</figure>
</div>
<div id="fig-data5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-data5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Full Join
</figcaption>
<div aria-describedby="fig-data5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/full_join.png" class="img-fluid figure-img" style="width:40.0%">
</div>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>students <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Kim"</span>, <span class="st">"Lee"</span>, <span class="st">"Park"</span>))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">score =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">85</span>, <span class="dv">70</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(students, scores, <span class="at">by =</span> <span class="st">"id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>iris</code> 데이터셋은 <code>R</code>에서 기본으로 제공되는 <strong>대표적인 내장 데이터셋</strong> 중 하나로,<br>
<strong>붓꽃(iris) 3종류에 대한 꽃받침과 꽃잎의 길이/너비</strong> 정보를 담고 있다.</p>
<p>총 <strong>150개의 관측값(행)</strong>과 <strong>5개의 변수(열)</strong>로 구성되어 있으며, 각 변수는 다음과 같은 정보를 담고 있다:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>변수 이름</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Sepal.Length</code></td>
<td>꽃받침 길이 (cm)</td>
</tr>
<tr class="even">
<td><code>Sepal.Width</code></td>
<td>꽃받침 너비 (cm)</td>
</tr>
<tr class="odd">
<td><code>Petal.Length</code></td>
<td>꽃잎 길이 (cm)</td>
</tr>
<tr class="even">
<td><code>Petal.Width</code></td>
<td>꽃잎 너비 (cm)</td>
</tr>
<tr class="odd">
<td><code>Species</code></td>
<td>붓꽃의 품종 (<code>setosa</code>, <code>versicolor</code>, <code>virginica</code>)</td>
</tr>
</tbody>
</table>
<p>앞서 배운 <code>head()</code>, <code>dim()</code>, <code>str()</code> 등의 함수를 이용하면<br>
<code>iris</code> 데이터셋의 <strong>기본 구조와 내용을 빠르게 파악</strong>할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)    <span class="co"># 상위 6행 출력 (미리 보기)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(iris)     <span class="co"># 행과 열의 개수 확인 150 5</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)     <span class="co"># 변수의 타입과 예시 값 확인</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="rbind와-cbind-행열-결합-함수" class="level3">
<h3 class="anchored" data-anchor-id="rbind와-cbind-행열-결합-함수">2.5.1 <code>rbind()</code>와 <code>cbind()</code> — 행/열 결합 함수</h3>
<p><code>R</code>에서는 데이터프레임이나 행렬을 <strong>행(row) 또는 열(column)</strong> 방향으로<br>
결합할 때 <code>rbind()</code>와 <code>cbind()</code> 함수를 사용한다.</p>
<p>이를 <code>iris</code> 데이터셋을 통해 직접 살펴보자.</p>
<section id="rbind-행-결합-아래로-붙이기" class="level4">
<h4 class="anchored" data-anchor-id="rbind-행-결합-아래로-붙이기"><code>rbind()</code> — 행 결합 (아래로 붙이기)</h4>
<p><code>rbind()</code>는 두 개 이상의 데이터프레임을 <strong>행 방향으로 결합</strong>한다.<br>
즉, <strong>관측값(행)</strong>을 추가하는 경우에 사용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>new_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sepal.Length =</span> <span class="fl">5.1</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sepal.Width =</span> <span class="fl">3.5</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Petal.Length =</span> <span class="fl">1.4</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Petal.Width =</span> <span class="fl">0.2</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Species =</span> <span class="st">"setosa"</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>iris_extended <span class="ot">&lt;-</span> <span class="fu">rbind</span>(iris, new_row)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(iris_extended)   <span class="co"># 151</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(iris_extended)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>열 이름과 순서가 기존 데이터프레임과 동일해야 결합 가능</li>
</ul>
</section>
<section id="cbind-열-결합-옆으로-붙이기" class="level4">
<h4 class="anchored" data-anchor-id="cbind-열-결합-옆으로-붙이기"><code>cbind()</code> — 열 결합 (옆으로 붙이기)</h4>
<p><code>cbind()</code>는 두 개 이상의 벡터 또는 데이터프레임을 열 방향으로 결합한다. 즉, <strong>새로운 변수(열)</strong>을 추가할 때 사용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>New_Var <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">150</span>)   <span class="co"># 임의의 수치형 벡터</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>iris_with_new <span class="ot">&lt;-</span> <span class="fu">cbind</span>(iris, New_Var)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris_with_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="데이터프레임-서브세팅" class="level2">
<h2 class="anchored" data-anchor-id="데이터프레임-서브세팅">2.6 데이터프레임 서브세팅</h2>
<p>데이터 분석에서 <strong>서브세팅(subsetting)</strong>은 원하는 조건에 맞는 일부 데이터만 추출하는 중요한 작업이다. 이번에는 <code>iris</code> 데이터셋을 중심으로 다양한 서브세팅 방법들을 살펴보자.</p>
<section id="조건에-맞는-행-추출" class="level3">
<h3 class="anchored" data-anchor-id="조건에-맞는-행-추출">2.6.1 조건에 맞는 행 추출</h3>
<p><code>Species</code>가 <code>"setosa"</code>인 행만 추출하고 싶다면:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>iris[iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">"setosa"</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>비슷하게, <code>Sepal.Length</code>가 5보다 큰 행만 추출하려면:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>iris[iris<span class="sc">$</span>Sepal.Length <span class="sc">&gt;</span> <span class="dv">5</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subset-함수-사용하기" class="level3">
<h3 class="anchored" data-anchor-id="subset-함수-사용하기">2.6.2 <code>subset()</code> 함수 사용하기</h3>
<p><code>subset()</code> 함수는 조건에 맞는 행 추출을 보다 간결하게 표현할 수 있도록 도와준다.</p>
<p>기본형식: <code>subset(x, subset, select)</code></p>
<ul>
<li><code>x</code>: 데이터프레임</li>
<li><code>subset</code>: 행 필터 조건</li>
<li><code>select</code>: 선택할 열 이름</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(iris, Species <span class="sc">==</span> <span class="st">"setosa"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(iris, Sepal.Length <span class="sc">&gt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>다음과 같이 복수 조건을 사용할 수 있다. <code>|</code> 기호는 <code>R</code>에서 <code>or</code> 조건을, <code>&amp;</code> 기호는 <code>and</code> 조건을 의미한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Species가 setosa 또는 virginica인 경우</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(iris, Species <span class="sc">==</span> <span class="st">"setosa"</span> <span class="sc">|</span> Species <span class="sc">==</span> <span class="st">"virginica"</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Species가 setosa이면서 Sepal.Length가 5보다 큰 경우</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(iris, Species <span class="sc">==</span> <span class="st">"setosa"</span> <span class="sc">&amp;</span> Sepal.Length <span class="sc">&gt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>위의 코드를 <code>subset()</code> 함수 없이 작성한다면:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>iris[iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">"setosa"</span> <span class="sc">|</span> iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">"virginica"</span>, <span class="st">"Sepal.Length"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="dplyr-패키지" class="level1">
<h1>3. <code>dplyr</code> 패키지</h1>
<p><code>dplyr</code> 패키지는 데이터프레임을 쉽고 직관적으로 다룰 수 있도록 도와주는 R의 핵심 패키지로, 열 선택, 행 필터링, 정렬, 요약, 그룹화 등 다양한 데이터 처리 작업을 간편하게 수행할 수 있다.</p>
<div id="fig-data6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-data6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Dplyr
</figcaption>
<div aria-describedby="fig-data6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./images/tidy2.png" class="img-fluid figure-img" style="width:80.0%">
</div>
</figure>
</div>
<p>다음은 <code>dplyr</code>에서 자주 사용되는 주요 함수들이다.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>함수</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>filter()</code></td>
<td>조건에 맞는 행만 추출</td>
</tr>
<tr class="even">
<td><code>select()</code></td>
<td>특정 열만 선택</td>
</tr>
<tr class="odd">
<td><code>arrange()</code></td>
<td>지정한 열을 기준으로 행 정렬</td>
</tr>
<tr class="even">
<td><code>mutate()</code></td>
<td>새로운 열 추가 또는 기존 열 변형</td>
</tr>
<tr class="odd">
<td><code>summarise()</code></td>
<td>요약 통계 계산 (예: 평균, 합계 등)</td>
</tr>
<tr class="even">
<td><code>group_by()</code></td>
<td>그룹 단위 연산을 위해 그룹화</td>
</tr>
<tr class="odd">
<td><code>slice()</code></td>
<td>행 번호를 기준으로 행 추출</td>
</tr>
</tbody>
</table>
<p>이번 교육에서는 <code>ggplot2</code> 패키지에 포함된 <code>diamonds</code> 데이터를 사용한다. <code>diamonds</code> 데이터는 약 54,000개의 다이아몬드에 대한 물리적 특성과 가격 정보를 포함한 데이터셋으로, <code>ggplot2</code> 패키지에 내장되어 있어 데이터 시각화 연습에 자주 사용된다.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 58%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>변수</th>
<th>설명</th>
<th>자료형</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>carat</code></td>
<td>다이아몬드 무게 (캐럿)</td>
<td>numeric</td>
</tr>
<tr class="even">
<td><code>cut</code></td>
<td>컷 품질 (Fair, Good, Very Good, Premium, Ideal)</td>
<td>ordered factor</td>
</tr>
<tr class="odd">
<td><code>color</code></td>
<td>색 등급 (D~J, D가 가장 우수)</td>
<td>ordered factor</td>
</tr>
<tr class="even">
<td><code>clarity</code></td>
<td>투명도 등급 (I1~IF, IF가 가장 우수)</td>
<td>ordered factor</td>
</tr>
<tr class="odd">
<td><code>depth</code></td>
<td>전체 깊이 비율 = z / mean(x, y)</td>
<td>numeric</td>
</tr>
<tr class="even">
<td><code>table</code></td>
<td>테이블 비율 = x축 기준 윗면 폭 비율</td>
<td>numeric</td>
</tr>
<tr class="odd">
<td><code>price</code></td>
<td>가격 (USD)</td>
<td>integer</td>
</tr>
<tr class="even">
<td><code>x</code></td>
<td>길이 (mm)</td>
<td>numeric</td>
</tr>
<tr class="odd">
<td><code>y</code></td>
<td>너비 (mm)</td>
<td>numeric</td>
</tr>
<tr class="even">
<td><code>z</code></td>
<td>깊이 (mm)</td>
<td>numeric</td>
</tr>
</tbody>
</table>
<section id="파이프-연산자" class="level2">
<h2 class="anchored" data-anchor-id="파이프-연산자">3.1 파이프 연산자</h2>
<p><code>dplyr</code>에서 자주 사용되는 파이프 연산자 (<code>%&gt;%</code>)는 여러 연산을 연결한 문법으로 표현 할 수 있게 해주는 핵심 도구이다.</p>
<p><code>%&gt;%</code>는 앞에서 수행한 결과를 다음 함수의 첫 번째 인자로 전달하는 연산자로 복잡한 중첩 함수 호출 없이 가독성 좋고 직관적인 코드를 작성하기 위해 사용된다.</p>
<p>기본 사용 형태</p>
<p>data %&gt;% function1() %&gt;% function2() %&gt;% function3()</p>
<p>이는 아래와 동일한 의미이다.</p>
<p>function3(function2(function1(data)))</p>
<p>다음의 예제는 같은 결과를 보여주는 코드이다. 첫 번째는 파이프 연산자를 사용한 방식이고, 두 번째는 파이프 없이 중첩 함수 호출로 작성한 방식이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%&gt;%</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>%&gt;%</code>는 <code>ctrl</code> + <code>shift</code> + <code>M</code> 단축키로 쉽게 불러올 수 있다.</p>
</section>
<section id="select" class="level2">
<h2 class="anchored" data-anchor-id="select">3.2 <code>select()</code></h2>
<p><code>select()</code> 함수는 데이터프레임에서 원하는 열(column)만 선택할 수 있도록 해주는 함수이다,</p>
<section id="주요-사용-예시" class="level3">
<h3 class="anchored" data-anchor-id="주요-사용-예시">주요 사용 예시</h3>
<p><code>diamonds</code> 데이터를 이용하여 <code>carat</code>과 <code>price</code> 열을 선택해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(diamonds, carat, price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이번에는 파이프 연산자 <code>%&gt;%</code>를 이용해 같은 작업을 수행해보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carat, price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>c()</code> 함수를 이용해서 열을 선택할 수도 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(carat, price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>열의 위치를 인덱스하여 <code>select()</code> 함수를 이용할 수도 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>c</code>로 시작하는 열만 선택하고자 할 때는 <code>starts_with()</code> 함수를 사용한다. 이 경우 <code>carat</code>, <code>cut</code>, <code>color</code>, <code>clarity</code> 열이 선택된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"c"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>contains()</code> 함수는 열 이름에 특정 문자열이 포함된 모든 열을 선택할 때 사용한다. 예를 들어 <code>"l"</code>이 포함된 열을 선택하면 <code>color</code>, <code>clarity</code>, <code>table</code>이 선택된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">"l"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code>는 특정 열을 제외할 때 사용하는 연산자이다. 예를 들어 <code>-c(carat, price)</code>를 사용하면 <code>carat</code>과 <code>price</code>를 제외한 나머지 열이 선택된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>carat, <span class="sc">-</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter">3.3 <code>filter()</code></h2>
<p><code>filter()</code> 함수는 조건에 맞는 행(row)만 추출할 때 사용하는 함수이다.<br>
즉, 데이터프레임에서 원하는 조건을 만족하는 행만 선택하고 나머지는 제거된다.</p>
<section id="자주-사용하는-논리-연산자" class="level4">
<h4 class="anchored" data-anchor-id="자주-사용하는-논리-연산자">자주 사용하는 논리 연산자:</h4>
<ul>
<li><code>==</code> : 같다<br>
</li>
<li><code>!=</code> : 같지 않다<br>
</li>
<li><code>&gt;</code> : 초과<br>
</li>
<li><code>&lt;</code> : 미만<br>
</li>
<li><code>&gt;=</code> : 이상<br>
</li>
<li><code>&lt;=</code> : 이하<br>
</li>
<li><code>&amp;</code> : 그리고 (AND)<br>
</li>
<li><code>|</code> : 또는 (OR)<br>
</li>
<li><code>!</code> : 부정 (NOT)</li>
</ul>
</section>
<section id="주요-사용-예시-1" class="level3">
<h3 class="anchored" data-anchor-id="주요-사용-예시-1">주요 사용 예시</h3>
<p><code>diamonds</code> 데이터에서 <code>cut</code>이 <code>"Ideal"</code>인 행만 추출하고 싶은 경우, <code>filter()</code> 함수를 다음과 같이 사용한다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cut <span class="sc">==</span> <span class="st">"Ideal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>%in%</code>은 여러 값을 동시에 조건으로 지정하고 싶을 때 사용하는 연산자이다.<br>
특히 <code>filter()</code> 함수와 함께 쓰면, 여러 값 중 하나라도 일치하는 행을 선택할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cut <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Ideal"</span>, <span class="st">"Good"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>다음과 같은 논리 연산자를 이용해서도 조건에 따라 데이터를 필터링할 수 있다.<br>
예를 들어, <code>price</code>가 1000을 초과하는 행만 추출하고 싶다면 다음과 같이 작성한다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price <span class="sc">&gt;=</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>price</code>가 1000이 아닌 모든 행을 추출하고자 한다면.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(price <span class="sc">!=</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>carat</code>이 2보다 크고 <code>price</code>가 14000보다 작은 행을 추출하고자 한다면</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(carat <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> price <span class="sc">&lt;</span> <span class="dv">14000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>carat</code>이 1보다 작거나 5보다 큰 행만 추출하고자 한다면</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(carat <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">|</span> carat <span class="sc">&gt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="slice" class="level2">
<h2 class="anchored" data-anchor-id="slice">3.4 <code>slice()</code></h2>
<p><code>slice()</code> 함수는 <code>filter()</code>와는 달리 조건이 아닌 행 번호(index 또는 위치)를 기준으로 행을 선택할 때 사용하는 함수이다. 즉, 데이터프레임에서 특정 위치에 있는 행만 선택하고 나머지는 제거된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>또는 <code>c()</code> 형태로도 행을 선택할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">15</span><span class="sc">:</span><span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1행을 제외한 모든 행을 선택하고자 하는경우는 다음과 같이 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mutate" class="level2">
<h2 class="anchored" data-anchor-id="mutate">3.5 <code>mutate()</code></h2>
<p><code>mutate()</code> 함수는 기존 열을 변형하거나 새로운 열을 추가할 때 사용하는 함수이다. 데이터프레임에 새로운 변수(column)를 생성하거나 기존 변수의 값을 바꿀 수 있는 함수이다.</p>
<p>예를 들어, <code>price/carat</code>의 비율을 나타내는 새로운 열을 만들어보자:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(price<span class="sc">/</span>carat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>하지만 이 코드만으로는 열의 이름이 지정되지 않았고, 열이 너무 많아서 출력 시 새로 만든 열이 보이지 않을 수 있다. 이럴 때는 앞에서 배운 <code>select()</code> 함수를 사용해 관심 있는 열만 선택한 뒤, <code>mutate()</code>로 새 열을 추가하면 더 명확하게 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carat, price) <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(price<span class="sc">/</span>carat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이제 새로 만든 열에 <code>Ratio</code>라는 이름을 부여해보자:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carat, price) <span class="sc">%&gt;%</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> price<span class="sc">/</span>carat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기서 <code>Ratio</code> 값을 이용해 새로운 열을 연쇄적으로 만들 수도 있다. 예를 들어, <code>Ratio</code>에 2를 곱한 값을 <code>Double</code>이라는 이름으로 추가하면 다음과 같다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carat, price) <span class="sc">%&gt;%</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> price<span class="sc">/</span>carat,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Double =</span> Ratio<span class="sc">*</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이처럼 <code>mutate()</code>는 다른 열을 조합하거나 가공하여 여러 새로운 변수들을 동시에 생성하는 데 매우 유용하다.</p>
<p>여기서 중요한 점은, <code>%&gt;%</code>, <code>mutate()</code> 등과 같은 함수들을 사용해 데이터를 처리하더라도 원본 데이터는 실제로 변경되지 않는다는 것이다. diamonds 데이터프레임 자체는 그대로 유지되고, 변형된 결과는 일시적으로 출력될 뿐이다.</p>
<p>따라서, 우리가 만든 새로운 데이터를 보존하여 나중에 다시 사용하고 싶다면, 결과를 새로운 객체에 할당해주어야 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>dia_ratio <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(carat, price) <span class="sc">%&gt;%</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> price<span class="sc">/</span>carat,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Double =</span> Ratio<span class="sc">*</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize" class="level2">
<h2 class="anchored" data-anchor-id="summarize">3.6 <code>summarize()</code></h2>
<p><code>summarize()</code> 함수(또는 <code>summarise()</code>)는 데이터의 요약 통계량을 계산할 때 사용하는 함수이다. 데이터프레임 전체 또는 그룹별로 평균, 합계, 개수, 최대값, 최소값 등을 계산할 때 사용된다.</p>
<p>예를 들어, <code>diamonds</code> 데이터프레임에서 <code>price</code>의 평균을 계산하려면 다음과 같이 작성할 수 있다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>summarize()</code> 함수에서는 평균뿐 아니라 다양한 통계량 계산도 간단히 수행할 수 있다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">AvgPrice =</span> <span class="fu">mean</span>(price),</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">MedianPrice =</span> <span class="fu">median</span>(price),</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">Avgcarat =</span> <span class="fu">mean</span>(carat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>summarize()</code>는 단독으로도 사용할 수 있지만, <code>group_by()</code>와 함께 사용하면 그룹별 통계량을 계산하는 데 특히 유용하다.</p>
</section>
<section id="group_by" class="level2">
<h2 class="anchored" data-anchor-id="group_by">3.7 <code>group_by()</code></h2>
<p><code>group_by()</code> 함수는 데이터를 특정 변수(또는 변수들)를 기준으로 그룹화할 때 사용하는 함수이다. 이 함수는 보통 <code>summarize()</code>와 함께 사용되어, 각 그룹별로 요약 통계량을 계산할 수 있게 한다.</p>
<p>예를 들어, <code>cut</code>의 종류별로 <code>price</code>의 평균을 계산하려면 다음과 같이 작성한다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cut) <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">AvgPrice =</span> <span class="fu">mean</span>(price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이번에는 <code>cut</code>과 <code>color</code> 두 가지 기준으로 그룹화한 후, <code>price</code>의 평균과 <code>carat</code>의 합계를 함께 계산해보자:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cut, color) <span class="sc">%&gt;%</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">AvgPrice =</span> <span class="fu">mean</span>(price), <span class="at">SumCarat =</span> <span class="fu">sum</span>(carat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>조금 더 나아가서, 이 중 <code>cut</code> == <code>"Fair"</code>인 그룹만 추출하고 싶다면 다음과 같이 작성한다:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cut, color) <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">AvgPrice =</span> <span class="fu">mean</span>(price), <span class="at">SumCarat =</span> <span class="fu">sum</span>(carat)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cut <span class="sc">==</span> <span class="st">"Fair"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="arrange" class="level2">
<h2 class="anchored" data-anchor-id="arrange">3.8 <code>arrange()</code></h2>
<p><code>arrange()</code> 함수는 데이터를 특정 변수(열)의 값을 기준으로 정렬할 때 사용하는 함수이다. 기본적으로 오름차순 정렬을 수행하며, desc() 함수를 함께 사용하면 내림차순 정렬도 가능하다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cut) <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">AvgPrice =</span> <span class="fu">mean</span>(price), <span class="at">SumCarat =</span> <span class="fu">sum</span>(carat)) <span class="sc">%&gt;%</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(AvgPrice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cut) <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">AvgPrice =</span> <span class="fu">mean</span>(price), <span class="at">SumCarat =</span> <span class="fu">sum</span>(carat)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">desc</span>(AvgPrice)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>지금까지 배운 함수를 이용하여 다음과 같은 분석을 수행해보자.</p>
<ul>
<li>cut이 <code>"Ideal"</code> 또는 <code>"Premium"</code>인 다이아몬드 중에서</li>
<li><code>carat</code>, <code>price</code>, <code>cut</code>, <code>color</code> 변수만 선택하고</li>
<li><code>price</code> 대비 <code>carat</code> 비율(<code>carat_per_dollar</code>)을 계산한 후</li>
<li><code>cut</code>과 <code>color</code>별로 그룹화하여</li>
<li><code>carat_per_dollar</code>의 평균과 최대값을 구하고</li>
<li>평균이 높은 순서대로 정렬한다</li>
</ul>
</section>
</section>
<section id="ggplot2의-이해와-활용" class="level1">
<h1>4. ggplot2의 이해와 활용</h1>
<section id="왜-ggplot2를-쓰는가" class="level2">
<h2 class="anchored" data-anchor-id="왜-ggplot2를-쓰는가">왜 ggplot2를 쓰는가</h2>
<p>R의 기본 그래픽(<code>plot()</code>)만으로도 시각화는 가능하다. 다만 그림이 조금만 복잡해져도 <strong>수정/확장</strong>이 불편해진다.<br>
예를 들어 색, 범례, 조건별 비교(facet), 통계적 요약(추세선) 등을 추가하려면 옵션을 하나씩 수동으로 만져야 한다.</p>
<p>반면 <code>ggplot2</code>는 <strong>그래픽 문법(grammar of graphics)</strong>에 기반해, 그림을 <strong>레이어(layer)</strong>로 쌓아 올리는 방식으로 작성한다.<br>
그래서 다음과 같은 장점이 생긴다.</p>
<ul>
<li>코드 구조가 일정해 <strong>재사용/수정/확장</strong>이 쉽다.</li>
<li>변수와 시각적 속성(aes)을 연결해 <strong>일관된 표현</strong>이 가능하다.</li>
<li><code>facet</code>, <code>theme</code>, <code>scale</code> 같은 기능으로 <strong>표현을 체계적으로 확장</strong>한다.</li>
<li><code>dplyr</code>로 집계한 결과를 그대로 이어서 시각화하기 좋다.</li>
</ul>
<section id="기본-plot-vs-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="기본-plot-vs-ggplot2">기본 plot vs ggplot2</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base plot</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mpg<span class="sc">$</span>displ, mpg<span class="sc">$</span>hwy,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"base plot: displ vs hwy"</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"displ"</span>, <span class="at">ylab =</span> <span class="st">"hwy"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ggplot2: displ vs hwy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="강의-목표" class="level2">
<h2 class="anchored" data-anchor-id="강의-목표">강의 목표</h2>
<p>이번 실습에서는 <code>ggplot2</code>의 기본 문법을 <code>mpg</code> 데이터로 익힌다.</p>
<ul>
<li><code>ggplot(data) + aes(...) + geom_*()</code> 기본 구조를 이해한다</li>
<li>산점도/막대그래프/박스플롯의 핵심 문법을 실습한다</li>
<li><code>facet_*</code>, <code>theme</code>, <code>scale_*</code>로 표현을 확장한다</li>
<li><code>dplyr</code> 집계 후 시각화까지 연결한다</li>
</ul>
<hr>
</section>
<section id="패키지-로드와-데이터-확인" class="level2">
<h2 class="anchored" data-anchor-id="패키지-로드와-데이터-확인">4.0 패키지 로드와 데이터 확인</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class 
  &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; 
1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compa…
2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compa…
3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compa…
4 audi         a4      2    2008     4 auto(av)   f        21    30 p     compa…
5 audi         a4      2.8  1999     6 auto(l5)   f        16    26 p     compa…
6 audi         a4      2.8  1999     6 manual(m5) f        18    26 p     compa…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [234 × 11] (S3: tbl_df/tbl/data.frame)
 $ manufacturer: chr [1:234] "audi" "audi" "audi" "audi" ...
 $ model       : chr [1:234] "a4" "a4" "a4" "a4" ...
 $ displ       : num [1:234] 1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...
 $ year        : int [1:234] 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...
 $ cyl         : int [1:234] 4 4 4 4 6 6 6 4 4 4 ...
 $ trans       : chr [1:234] "auto(l5)" "manual(m5)" "manual(m6)" "auto(av)" ...
 $ drv         : chr [1:234] "f" "f" "f" "f" ...
 $ cty         : int [1:234] 18 21 20 21 16 18 18 18 16 20 ...
 $ hwy         : int [1:234] 29 29 31 30 26 26 27 26 25 28 ...
 $ fl          : chr [1:234] "p" "p" "p" "p" ...
 $ class       : chr [1:234] "compact" "compact" "compact" "compact" ...</code></pre>
</div>
</div>
<p><code>mpg</code> 데이터는 자동차 연비 관련 데이터다.</p>
<ul>
<li><code>displ</code>: 엔진 배기량</li>
<li><code>hwy</code>: 고속도로 연비</li>
<li><code>cty</code>: 도심 연비</li>
<li><code>class</code>: 차종</li>
<li><code>drv</code>: 구동방식</li>
</ul>
<hr>
</section>
<section id="ggplot2의-기본-구조" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2의-기본-구조">4.1 ggplot2의 기본 구조</h2>
<p><code>ggplot2</code>는 보통 아래 형태로 작성한다.</p>
<ul>
<li><code>ggplot(data = ...)</code> : 사용할 데이터</li>
<li><code>aes(...)</code> : 매핑(미적 요소: x, y, color, size 등)</li>
<li><code>geom_*()</code> : 기하 객체(점/선/막대/상자그림 등)</li>
</ul>
<section id="가장-기본-산점도" class="level3">
<h3 class="anchored" data-anchor-id="가장-기본-산점도">4.1.1 가장 기본: 산점도</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="미적요소aes-확장-색투명도" class="level2">
<h2 class="anchored" data-anchor-id="미적요소aes-확장-색투명도">4.2. 미적요소(aes) 확장: 색/투명도</h2>
<section id="범주형-변수를-색으로" class="level3">
<h3 class="anchored" data-anchor-id="범주형-변수를-색으로">4.2.1 범주형 변수를 색으로</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="점-겹침-완화-투명도alpha" class="level3">
<h3 class="anchored" data-anchor-id="점-겹침-완화-투명도alpha">4.2.2 점 겹침 완화: 투명도(alpha)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p><code>alpha</code>는 0~1 사이 값이며, 값이 작을수록 더 투명해진다.</p>
</blockquote>
<hr>
</section>
</section>
<section id="레이어-추가-추세선geom_smooth" class="level2">
<h2 class="anchored" data-anchor-id="레이어-추가-추세선geom_smooth">4.3. 레이어 추가: 추세선(geom_smooth)</h2>
<section id="전체-추세선비선형-스무딩" class="level3">
<h3 class="anchored" data-anchor-id="전체-추세선비선형-스무딩">4.3.1 전체 추세선(비선형 스무딩)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="선형회귀-추세선method-lm" class="level3">
<h3 class="anchored" data-anchor-id="선형회귀-추세선method-lm">4.3.2 선형회귀 추세선(method = “lm”)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="facet으로-그룹-비교" class="level2">
<h2 class="anchored" data-anchor-id="facet으로-그룹-비교">4.4. facet으로 그룹 비교</h2>
<section id="차종별로-나누어-보기" class="level3">
<h3 class="anchored" data-anchor-id="차종별로-나누어-보기">4.4.1 차종별로 나누어 보기</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="구동방식별로-나누어-보기" class="level3">
<h3 class="anchored" data-anchor-id="구동방식별로-나누어-보기">4.4.2 구동방식별로 나누어 보기</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> drv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="범주형-그래프-막대그래프-박스플롯" class="level2">
<h2 class="anchored" data-anchor-id="범주형-그래프-막대그래프-박스플롯">4.5. 범주형 그래프: 막대그래프 / 박스플롯</h2>
<section id="막대그래프빈도" class="level3">
<h3 class="anchored" data-anchor-id="막대그래프빈도">4.5.1 막대그래프(빈도)</h3>
<p><code>geom_bar()</code>는 기본적으로 <strong>개수(count)</strong>를 센다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>레이블이 겹치면 회전해서 가독성을 높인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class)) <span class="sc">+</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="박스플롯-차종별-고속도로-연비-분포" class="level3">
<h3 class="anchored" data-anchor-id="박스플롯-차종별-고속도로-연비-분포">4.5.2 박스플롯: 차종별 고속도로 연비 분포</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>점도 같이 찍으면 분포가 더 직관적으로 보인다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="집계-후-시각화-dplyr-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="집계-후-시각화-dplyr-ggplot2">4.6. 집계 후 시각화: dplyr + ggplot2</h2>
<section id="차종별-평균-hwy-계산" class="level3">
<h3 class="anchored" data-anchor-id="차종별-평균-hwy-계산">4.6.1 차종별 평균 hwy 계산</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>mpg_sum <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_hwy =</span> <span class="fu">mean</span>(hwy),</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>mpg_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  class      mean_hwy     n
  &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;
1 2seater        24.8     5
2 compact        28.3    47
3 midsize        27.3    41
4 minivan        22.4    11
5 pickup         16.9    33
6 subcompact     28.1    35
7 suv            18.1    62</code></pre>
</div>
</div>
</section>
<section id="평균-연비-막대그래프geom_col" class="level3">
<h3 class="anchored" data-anchor-id="평균-연비-막대그래프geom_col">4.6.2 평균 연비 막대그래프(geom_col)</h3>
<p><code>geom_col()</code>은 y값을 <strong>그대로 사용</strong>한다(집계된 데이터에 적합하다).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg_sum, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> mean_hwy)) <span class="sc">+</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="값-기준-정렬reorder-가독성축-뒤집기" class="level3">
<h3 class="anchored" data-anchor-id="값-기준-정렬reorder-가독성축-뒤집기">4.6.3 값 기준 정렬(reorder) + 가독성(축 뒤집기)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg_sum, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(class, mean_hwy), <span class="at">y =</span> mean_hwy)) <span class="sc">+</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"class"</span>,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"평균 고속도로 연비(mean hwy)"</span>,</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"차종별 평균 고속도로 연비(정렬)"</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="라벨제목범례-설정-labs" class="level2">
<h2 class="anchored" data-anchor-id="라벨제목범례-설정-labs">4.7. 라벨/제목/범례 설정: labs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"배기량과 고속도로 연비의 관계"</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"구동방식(drv)별로 색상 구분"</span>,</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"배기량(displ)"</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"고속도로 연비(hwy)"</span>,</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"구동방식"</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="테마theme-전체-스타일-바꾸기" class="level2">
<h2 class="anchored" data-anchor-id="테마theme-전체-스타일-바꾸기">4.8. 테마(theme): 전체 스타일 바꾸기</h2>
<p>대표적으로 많이 쓰는 테마는 다음과 같다.</p>
<ul>
<li><code>theme_minimal()</code></li>
<li><code>theme_bw()</code></li>
<li><code>theme_classic()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="스케일scale-축-변환범위-조정" class="level2">
<h2 class="anchored" data-anchor-id="스케일scale-축-변환범위-조정">4.9. 스케일(scale): 축 변환/범위 조정</h2>
<section id="y축-범위-제한주의-범위-밖-데이터는-잘린다" class="level3">
<h3 class="anchored" data-anchor-id="y축-범위-제한주의-범위-밖-데이터는-잘린다">4.9.1 y축 범위 제한(주의: 범위 밖 데이터는 잘린다)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="로그-스케일분포가-한쪽으로-치우친-경우" class="level3">
<h3 class="anchored" data-anchor-id="로그-스케일분포가-한쪽으로-치우친-경우">4.9.2 로그 스케일(분포가 한쪽으로 치우친 경우)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-123-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="저장하기-ggsave" class="level2">
<h2 class="anchored" data-anchor-id="저장하기-ggsave">4.10. 저장하기: ggsave</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy, <span class="at">color =</span> drv)) <span class="sc">+</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_R_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"mpg_scatter.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="연습문제" class="level2">
<h2 class="anchored" data-anchor-id="연습문제">4.11. 연습문제</h2>
<section id="연습-1" class="level3">
<h3 class="anchored" data-anchor-id="연습-1">연습 1</h3>
<p><code>cty</code>(도심연비)와 <code>hwy</code>(고속도로연비)의 관계를 산점도로 그리고, <code>class</code>로 색을 구분해보자.</p>
<p>힌트: - <code>aes(x = cty, y = hwy, color = class)</code> - <code>geom_point()</code></p>
</section>
<section id="연습-2" class="level3">
<h3 class="anchored" data-anchor-id="연습-2">연습 2</h3>
<p><code>class</code>별 <code>hwy</code>의 분포를 박스플롯으로 그린 뒤, x축 레이블 겹침을 해결해보자.</p>
<p>힌트: - <code>theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></p>
</section>
<section id="연습-3" class="level3">
<h3 class="anchored" data-anchor-id="연습-3">연습 3</h3>
<p><code>drv</code>별 평균 <code>hwy</code>를 계산한 뒤 막대그래프로 나타내보자.</p>
<p>힌트: - <code>group_by(drv) %&gt;% summarise(mean_hwy = mean(hwy))</code> - <code>geom_col()</code></p>
<hr>
</section>
</section>
<section id="요약" class="level2">
<h2 class="anchored" data-anchor-id="요약">요약</h2>
<ul>
<li><code>ggplot(data) + aes(...) + geom_*()</code>는 기본 뼈대다.</li>
<li><code>+</code>로 레이어를 쌓아 의미를 확장한다.</li>
<li>범주 비교는 <code>facet</code>, 스타일은 <code>theme</code>, 축/표현은 <code>scale</code>로 다룬다.</li>
<li>실무에서는 <code>dplyr</code>로 집계 후 <code>geom_col()</code> 조합을 자주 쓴다.</li>
</ul>
<p>연습 1: cty vs hwy 산점도 + class로 색 구분 ggplot(mpg, aes(x = cty, y = hwy, color = class)) + geom_point(alpha = 0.7) + labs( title = “cty vs hwy (class로 색 구분)”, x = “cty (도심 연비)”, y = “hwy (고속도로 연비)”, color = “class” )</p>
<p>연습 2: class별 hwy 박스플롯 + x축 레이블 겹침 해결 ggplot(mpg, aes(x = class, y = hwy)) + geom_boxplot(outlier.alpha = 0.3) + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs( title = “class별 hwy 분포(박스플롯)”, x = “class”, y = “hwy” )</p>
<p>연습 3: drv별 평균 hwy 계산 후 막대그래프(geom_col) mpg_drv &lt;- mpg %&gt;% group_by(drv) %&gt;% summarise(mean_hwy = mean(hwy), .groups = “drop”)</p>
<p>ggplot(mpg_drv, aes(x = drv, y = mean_hwy)) + geom_col() + labs( title = “drv별 평균 hwy”, x = “drv”, y = “mean(hwy)” )</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>